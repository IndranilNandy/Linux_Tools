#!/bin/bash

# Insert entry of this tool in .allTools. This is to be used in the verification stage post setup.
grep -q "nfs:" ../../_verify/.allTools || echo "nfs:mynfs" >>../../_verify/.allTools

#Check if all prerequisites are installed, and install the missing ones
prereq --install ".prereq"

# Exit if still missing any prerequisite
[[ $(prereq --missing ".prereq") ]] && echo -e "${RED}One or more prerequisites are still missing. Exiting.${RESET}" && exit 0

# Check if it is already installed
[[ -n $(which mynfs) ]] && echo -e "\n${GREEN}[NFS] Already installed. Exiting.${RESET}" && exit 0

echo -e "${YELLOW}[NFS] Setup process started.${RESET}"

read -p "Setup for NFS server or client? [server] or [client] or any other key to skip.. " ans
([[ "$(echo $ans | tr [:upper:] [:lower:])" == "server" ]] && ./nfs_setup.sh server --setup) || \
([[ "$(echo $ans | tr [:upper:] [:lower:])" == "client" ]] && ./nfs_setup.sh client --setup) || \
echo -e "Skipping NFS setup. Use 'mynfs' command to do the setup later.\nFor more, see 'mynfs --help'"

myscriptref --create nfs_setup.sh $HOME/MyTools/Linux_Tools/Env_setup_scripts/nfs mynfs
mycompl -W \"server client --setup --uninstall --config --refresh --prune --help\" mynfs

echo -e "${GREEN}[NFS] Setup finished.${RESET}"
