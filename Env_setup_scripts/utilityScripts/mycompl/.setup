#!/bin/bash

# Insert entry of this tool in .allTools. This is to be used in the verification stage post setup.
grep -q "mycompl:" ../../../_verify/.allTools || echo "mycompl:mycompl" >>../../../_verify/.allTools

#Check if all prerequisites are installed, and install the missing ones
prereq --install ".prereq"

# Exit if still missing any prerequisite
[[ $(prereq --missing ".prereq") ]] && echo -e "${RED}One or more prerequisites are still missing. Exiting.${RESET}" && exit 0

# Check if it is already installed
[[ -n $(which mycompl) ]] && echo -e "\n${GREEN}[mycompl] Already installed. Exiting.${RESET}" && exit 0

echo -e "${YELLOW}[mycompl] Setup process started.${RESET}"
yes | sudo ln -s -i $(pwd)/mycompl.sh $MYCOMMANDSREPO/mycompl
./mycompl_configurer.sh

mycompl -W \"--config --dynamic --temp --help\" mycompl

# Since, tracelink in installed before mycompl, adding the completion command for tracelink here.
mycompl -W \"--help\" tracelink

# Since, prereq in installed before mycompl, adding the completion command for tracelink here.
mycompl -W \"--list --missing --missingcount --help\" prereq

echo -e "${GREEN}[mycompl] Setup finished.${RESET}"
