#!/bin/bash

# Insert entry of this tool in .allTools. This is to be used in the verification stage post setup.
grep -q "sdkman:" ../../_verify/.allTools || echo "sdkman:sdk" >>../../_verify/.allTools

#Check if all prerequisites are installed, and install the missing ones
prereq --install ".prereq"

# Exit if still missing any prerequisite
[[ $(prereq --missing ".prereq") ]] && echo -e "${RED}One or more prerequisites are still missing. Exiting.${RESET}" && exit 0

# Check if it is already installed
echo "checking for installation"
verification_script=' source ~/.bashrc; \
sdk version >> /dev/null 2>&1 || exit 1; \
exit 0 '

bash --init-file <(echo "$verification_script;") && echo -e "\n${GREEN}[sdkman] Already installed. Exiting.${RESET}" && exit 0

echo -e "${YELLOW}[sdkman] Setup process started.${RESET}"

./sdkman_installer.sh
echo -e "${GREEN}[sdkman] Setup finished.${RESET}"
